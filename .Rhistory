data
}
}
path <- "C:/Users/kylewalker/Documents/Training/R/Computing for Data Analysis/specdata/specdata"
d <- getmonitor(236, path)
View(d)
attach(d)
d$complete <- complete.cases(d)
compdat <- d[d$complete==1, ]
detach(d)
attach(compdat)
cor(sulfate, nitrate)
result <- cor(sulfate, nitrate)
result
corr <- function(directory, threshold = 0) {
vec <- c()
for (i in 1:332) {
j <- as.character(sprintf("%03d", as.numeric(i)))
file <- paste0(directory, "/", j, ".csv")
dat <- read.csv(file)
dat$complete <- complete.cases(dat)
compdat <- dat[dat$complete==1, ]
l <- length(compdat)
if (l > threshold) {
result <- cor(compdat$sulfate, compdat$nitrate)
vec <- c(vec, result)
}
else {
next
}
}
vec
}
cr <- corr(path, 150)
head(cr)
length(compdat)
View(compdat)
i = 1
j <- as.character(sprintf("%03d", as.numeric(i)))
directory <- path
file <- paste0(directory, "/", j, ".csv")
dat <- read.csv(file)
dat$complete <- complete.cases(dat)
compdat <- dat[dat$complete==1, ]
View(compdat)
l <- length(compdat)
l
l <- sum(compdat$complete)
l <- length(compdat$complete)
corr <- function(directory, threshold = 0) {
vec <- c()
for (i in 1:332) {
j <- as.character(sprintf("%03d", as.numeric(i)))
file <- paste0(directory, "/", j, ".csv")
dat <- read.csv(file)
dat$complete <- complete.cases(dat)
compdat <- dat[dat$complete==1, ]
l <- length(compdat$complete)
if (l > threshold) {
result <- cor(compdat$sulfate, compdat$nitrate)
vec <- c(vec, result)
}
else {
next
}
}
vec
}
cr <- corr(path, 150)
head(cr)
summary(cr)
cr <- corr(path, 400)
head(cr)
summary(cr)
cr <- corr(path, 5000)
cr <- corr(path)
summary(cr)
length(cr)
source("http://spark-public.s3.amazonaws.com/compdata/scripts/corr-test.R")
corr.testscript()
setwd("~/Training/R/Computing for Data Analysis/specdata")
corr.testscript()
h2 <- Highcharts$new()
h2$xAxis(categories = c("Decile 1", "Decile 2", "Decile 3", "Decile 4", "Decile 5", "Decile 6", "Decile 7", "Decile 8",
"Decile 9", "Decile 10"))
h2$yAxis(list(title = list(text = 'Average hospitalization rate', style = list(color = '#DC143C'))),
list(title = list(text = 'Average percentage in poverty', style = list(color = '#006400')), opposite = TRUE))
h2$series(name = 'Average hospitalization rate', type = 'column', color = '#DC143C',
data = round(c(24.4231070607901, 35.1595941612124, 40.1250078815222, 44.7821202798188,
49.2256208330393, 53.0222471148376, 57.2887376938264, 62.1314025390148,
68.7185480312506, 94.6936301044623), 2))
h2$series(name = 'Average percentage in poverty', type = 'spline', color = '#006400', yAxis = 1,
data = round(c(9.9546666225791, 8.95600000460943, 10.5546666737398, 12.1706666739782,
11.7319999778271, 15.2550335106434, 15.1206666946411, 14.9506666731834,
15.4746667083104, 17.5753333171209), 2), yAxis = 1)
h2$chart(list(width = 1200, height = 600))
#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!#
#Chart 2: plot of relationship between poverty and hospitalization rates
#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!#
#Script to generate rCharts for October 11 presentation
dir <- "C:/Users/kylewalker/Dropbox/Health project/Data"
setwd(dir)
require(rCharts)
require(plyr)
require(reshape2)
require(foreign)
hd <- read.dta("heart_analysis.dta")
hdpov <- hd[c("age_adjusted_rate", "pct_pov")]
hdpov <- subset(hdpov, age_adjusted_rate < 1000)
# plot(hdpov$age_adjusted_rate, hdpov$pct_pov)
#
# m1 <- lm(hdpov$age_adjusted_rate~hdpov$pct_pov)
hdpov$decile <- cut(hdpov$age_adjusted_rate,
quantile(hdpov$age_adjusted_rate,
prob=seq(0, 1, 0.1)),
labels=FALSE,
include.lowest=TRUE)
means <- aggregate(hdpov, by=list(hdpov$decile), mean)
means <- means[-1]
means <- rename(means, c("age_adjusted_rate" = "Hospitalization.Rate",
"pct_pov" = "Poverty.Rate",
"decile" = "Decile"))
# n1 <- nvd3Plot(
#   x = "Decile",
#   y1 = "Poverty.Rate",
#   y2 = "Hospitalization.Rate",
#   data = means,
#   type = "linePlusBarChart",
#   height = 600,
#   width = 1200
# )
# n1$templates$script = file.path(n1$LIB$url,'layouts',"linePlusBar.html")
#
# n1
# dec <- paste(shQuote(means$Decile), collapse=", ")
# dec1 <- dput(as.character(means$Decile))
h2 <- Highcharts$new()
h2$xAxis(categories = c("Decile 1", "Decile 2", "Decile 3", "Decile 4", "Decile 5", "Decile 6", "Decile 7", "Decile 8",
"Decile 9", "Decile 10"))
h2$yAxis(list(title = list(text = 'Average hospitalization rate', style = list(color = '#DC143C'))),
list(title = list(text = 'Average percentage in poverty', style = list(color = '#006400')), opposite = TRUE))
h2$series(name = 'Average hospitalization rate', type = 'column', color = '#DC143C',
data = round(c(24.4231070607901, 35.1595941612124, 40.1250078815222, 44.7821202798188,
49.2256208330393, 53.0222471148376, 57.2887376938264, 62.1314025390148,
68.7185480312506, 94.6936301044623), 2))
h2$series(name = 'Average percentage in poverty', type = 'spline', color = '#006400', yAxis = 1,
data = round(c(9.9546666225791, 8.95600000460943, 10.5546666737398, 12.1706666739782,
11.7319999778271, 15.2550335106434, 15.1206666946411, 14.9506666731834,
15.4746667083104, 17.5753333171209), 2), yAxis = 1)
h2$chart(list(width = 1200, height = 600))
h2
h2$width = 1200
h2$height = 600
h2$publish("Heart disease and poverty", host="gist")
#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!#
#Chart 2: plot of relationship between poverty and hospitalization rates
#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!#
#Script to generate rCharts for October 11 presentation
dir <- "C:/Users/kylewalker/Dropbox/Health project/Data"
setwd(dir)
require(rCharts)
require(plyr)
require(reshape2)
require(foreign)
hd <- read.dta("heart_analysis.dta")
hdpov <- hd[c("age_adjusted_rate", "pct_pov")]
hdpov <- subset(hdpov, age_adjusted_rate < 1000)
# plot(hdpov$age_adjusted_rate, hdpov$pct_pov)
#
# m1 <- lm(hdpov$age_adjusted_rate~hdpov$pct_pov)
hdpov$decile <- cut(hdpov$age_adjusted_rate,
quantile(hdpov$age_adjusted_rate,
prob=seq(0, 1, 0.1)),
labels=FALSE,
include.lowest=TRUE)
means <- aggregate(hdpov, by=list(hdpov$decile), mean)
means <- means[-1]
means <- rename(means, c("age_adjusted_rate" = "Hospitalization.Rate",
"pct_pov" = "Poverty.Rate",
"decile" = "Decile"))
# n1 <- nvd3Plot(
#   x = "Decile",
#   y1 = "Poverty.Rate",
#   y2 = "Hospitalization.Rate",
#   data = means,
#   type = "linePlusBarChart",
#   height = 600,
#   width = 1200
# )
# n1$templates$script = file.path(n1$LIB$url,'layouts',"linePlusBar.html")
#
# n1
# dec <- paste(shQuote(means$Decile), collapse=", ")
# dec1 <- dput(as.character(means$Decile))
h2 <- Highcharts$new()
h2$xAxis(categories = c("Decile 1", "Decile 2", "Decile 3", "Decile 4", "Decile 5", "Decile 6", "Decile 7", "Decile 8",
"Decile 9", "Decile 10"))
h2$yAxis(list(title = list(text = 'Average hospitalization rate', style = list(color = '#DC143C'))),
list(title = list(text = 'Average percentage in poverty', style = list(color = '#006400')), opposite = TRUE))
h2$series(name = 'Average hospitalization rate', type = 'column', color = '#DC143C',
data = round(c(24.4231070607901, 35.1595941612124, 40.1250078815222, 44.7821202798188,
49.2256208330393, 53.0222471148376, 57.2887376938264, 62.1314025390148,
68.7185480312506, 94.6936301044623), 2))
h2$series(name = 'Average percentage in poverty', type = 'spline', color = '#006400', yAxis = 1,
data = round(c(9.9546666225791, 8.95600000460943, 10.5546666737398, 12.1706666739782,
11.7319999778271, 15.2550335106434, 15.1206666946411, 14.9506666731834,
15.4746667083104, 17.5753333171209), 2), yAxis = 1)
h2$publish("Heart disease and poverty", host="gist")
#Script to generate rCharts for October 11 presentation
dir <- "C:/Users/kylewalker/Dropbox/Health project/Data"
setwd(dir)
require(rCharts)
require(plyr)
require(reshape2)
#Chart 1: Bar chart of cluster race & ethnicity
dat <- read.csv("clusters2.csv")
#names(dat)
subvars <- c("cluster", "newpctwhite", "newpctblack", "newpcthisp")
sub <- dat[subvars]
means <- aggregate(sub, by=list(sub$cluster), mean)
means <- rename(means, c("cluster" = "Cluster",
"newpctwhite" = "White",
"newpctblack" = "Black",
"newpcthisp" = "Hispanic"))
means <- means[-1]
meltmeans <- melt(means, id="Cluster")
meltmeans$cl_str <- as.character(meltmeans$Cluster)
# #Script for NVD3 chart
# n <- nPlot(value~Cluster, group="variable", data=meltmeans, type="multiBarChart")
# #n$chart(color = c("996633", "66ff33", "003399", "cc3300"))
# n$chart(color = c("green", "purple", "orange"))
# n$chart(reduceXTicks= FALSE)
# n$yAxis(axisLabel = "Average percentage in zip code", width = 62)
# #n$yAxis(tickFormat= "#! function() {return d3.format(",.0f") } !#")
# n$xAxis(axisLabel = "Cluster")
# n$params$width = 1200
# n$params$height = 600
#Script for Highcharts
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h
#Script to generate rCharts for October 11 presentation
dir <- "C:/Users/kylewalker/Dropbox/Health project/Data"
setwd(dir)
require(rCharts)
require(plyr)
require(reshape2)
#Chart 1: Bar chart of cluster race & ethnicity
dat <- read.csv("clusters2.csv")
#names(dat)
subvars <- c("cluster", "newpctwhite", "newpctblack", "newpcthisp")
sub <- dat[subvars]
means <- aggregate(sub, by=list(sub$cluster), mean)
means <- rename(means, c("cluster" = "Cluster",
"newpctwhite" = "White",
"newpctblack" = "Black",
"newpcthisp" = "Hispanic"))
means <- means[-1]
meltmeans <- melt(means, id="Cluster")
meltmeans$cl_str <- paste0("Cluster ", as.character(meltmeans$Cluster)
# #Script for NVD3 chart
# n <- nPlot(value~Cluster, group="variable", data=meltmeans, type="multiBarChart")
# #n$chart(color = c("996633", "66ff33", "003399", "cc3300"))
# n$chart(color = c("green", "purple", "orange"))
# n$chart(reduceXTicks= FALSE)
# n$yAxis(axisLabel = "Average percentage in zip code", width = 62)
# #n$yAxis(tickFormat= "#! function() {return d3.format(",.0f") } !#")
# n$xAxis(axisLabel = "Cluster")
# n$params$width = 1200
# n$params$height = 600
#Script for Highcharts
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h1$yAxis(title = list(text = "Average ZCTA percentage of population"))
h1$xAxis(title = list(text = "Clusters"))
h
View(meltmeans)
View(meltmeans)
meltmeans$cl_str <- paste0("Cluster ", as.character(meltmeans$Cluster)
#Script to generate rCharts for October 11 presentation
dir <- "C:/Users/kylewalker/Dropbox/Health project/Data"
setwd(dir)
require(rCharts)
require(plyr)
require(reshape2)
#Chart 1: Bar chart of cluster race & ethnicity
dat <- read.csv("clusters2.csv")
#names(dat)
subvars <- c("cluster", "newpctwhite", "newpctblack", "newpcthisp")
sub <- dat[subvars]
means <- aggregate(sub, by=list(sub$cluster), mean)
means <- rename(means, c("cluster" = "Cluster",
"newpctwhite" = "White",
"newpctblack" = "Black",
"newpcthisp" = "Hispanic"))
means <- means[-1]
meltmeans <- melt(means, id="Cluster")
meltmeans$cl_str <- paste0("Cluster ", as.character(meltmeans$Cluster))
# #Script for NVD3 chart
# n <- nPlot(value~Cluster, group="variable", data=meltmeans, type="multiBarChart")
# #n$chart(color = c("996633", "66ff33", "003399", "cc3300"))
# n$chart(color = c("green", "purple", "orange"))
# n$chart(reduceXTicks= FALSE)
# n$yAxis(axisLabel = "Average percentage in zip code", width = 62)
# #n$yAxis(tickFormat= "#! function() {return d3.format(",.0f") } !#")
# n$xAxis(axisLabel = "Cluster")
# n$params$width = 1200
# n$params$height = 600
#Script for Highcharts
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h$yAxis(title = list(text = "Average ZCTA percentage of population"))
h$xAxis(title = list(text = "Clusters"))
h
View(meltmeans)
meltmeans$cl_str
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h$yAxis(title = list(text = "Average ZCTA percentage of population"))
h$xAxis(title = list(text = "Clusters"))
h
#Script for Highcharts
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h$yAxis(title = list(text = "Average ZCTA percentage of population"))
h$xAxis(title = list(text = "Clusters"))
h$xAxis(labels = list(formatter = "#! function() { return this.value; } !#"))
h
#Script for Highcharts
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h$yAxis(title = list(text = "Average ZCTA percentage of population"))
h$xAxis(title = list(text = "Clusters"))
h
mean(meltmeans$cl_str)
#Script to generate rCharts for October 11 presentation
dir <- "C:/Users/kylewalker/Dropbox/Health project/Data"
setwd(dir)
require(rCharts)
require(plyr)
require(reshape2)
#Chart 1: Bar chart of cluster race & ethnicity
dat <- read.csv("clusters2.csv")
#names(dat)
subvars <- c("cluster", "newpctwhite", "newpctblack", "newpcthisp")
sub <- dat[subvars]
means <- aggregate(sub, by=list(sub$cluster), mean)
means <- rename(means, c("cluster" = "Cluster",
"newpctwhite" = "White",
"newpctblack" = "Black",
"newpcthisp" = "Hispanic"))
means <- means[-1]
meltmeans <- melt(means, id="Cluster")
meltmeans$cl_str <- paste0("Cluster ", as.character(meltmeans$Cluster))
# #Script for NVD3 chart
# n <- nPlot(value~Cluster, group="variable", data=meltmeans, type="multiBarChart")
# #n$chart(color = c("996633", "66ff33", "003399", "cc3300"))
# n$chart(color = c("green", "purple", "orange"))
# n$chart(reduceXTicks= FALSE)
# n$yAxis(axisLabel = "Average percentage in zip code", width = 62)
# #n$yAxis(tickFormat= "#! function() {return d3.format(",.0f") } !#")
# n$xAxis(axisLabel = "Cluster")
# n$params$width = 1200
# n$params$height = 600
#Script for Highcharts
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h$yAxis(title = list(text = "Average ZCTA percentage of population"))
h$xAxis(title = list(text = "Clusters"))
h
#Script for Highcharts
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h$yAxis(title = list(text = "Average ZCTA percentage of population"))
h$xAxis(title = list(text = "Clusters"))
h$xAxis(categories = c("Cluster 1", "Cluster 2", "Cluster 3", "Cluster 4"))
h
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h$yAxis(title = list(text = "Average ZCTA percentage of population"))
h$xAxis(title = list(text = "Clusters"))
h$xAxis(categories = c("Cluster 1", "Cluster 2", "Cluster 3", "Cluster 4"))
h$params$height = 600
h$params$width = 1200
h
h2 <- Highcharts$new()
h2$xAxis(categories = c("Decile 1", "Decile 2", "Decile 3", "Decile 4", "Decile 5", "Decile 6", "Decile 7", "Decile 8",
"Decile 9", "Decile 10"))
h2$yAxis(list(title = list(text = 'Average hospitalization rate', style = list(color = '#DC143C'))),
list(title = list(text = 'Average percentage in poverty', style = list(color = '#006400')), opposite = TRUE))
h2$series(name = 'Average hospitalization rate', type = 'column', color = '#DC143C',
data = round(c(24.4231070607901, 35.1595941612124, 40.1250078815222, 44.7821202798188,
49.2256208330393, 53.0222471148376, 57.2887376938264, 62.1314025390148,
68.7185480312506, 94.6936301044623), 2))
h2$series(name = 'Average percentage in poverty', type = 'spline', color = '#006400', yAxis = 1,
data = round(c(9.9546666225791, 8.95600000460943, 10.5546666737398, 12.1706666739782,
11.7319999778271, 15.2550335106434, 15.1206666946411, 14.9506666731834,
15.4746667083104, 17.5753333171209), 2), yAxis = 1)
h2$params$height = 600
h2$params$width = 1200
h2
#Script to generate rCharts for October 11 presentation
dir <- "C:/Users/kylewalker/Dropbox/Health project/Data"
setwd(dir)
require(rCharts)
require(plyr)
require(reshape2)
#Chart 1: Bar chart of cluster race & ethnicity
dat <- read.csv("clusters2.csv")
#names(dat)
subvars <- c("cluster", "newpctwhite", "newpctblack", "newpcthisp")
sub <- dat[subvars]
means <- aggregate(sub, by=list(sub$cluster), mean)
means <- rename(means, c("cluster" = "Cluster",
"newpctwhite" = "White",
"newpctblack" = "Black",
"newpcthisp" = "Hispanic"))
means <- means[-1]
meltmeans <- melt(means, id="Cluster")
meltmeans$cl_str <- paste0("Cluster ", as.character(meltmeans$Cluster))
# #Script for NVD3 chart
# n <- nPlot(value~Cluster, group="variable", data=meltmeans, type="multiBarChart")
# #n$chart(color = c("996633", "66ff33", "003399", "cc3300"))
# n$chart(color = c("green", "purple", "orange"))
# n$chart(reduceXTicks= FALSE)
# n$yAxis(axisLabel = "Average percentage in zip code", width = 62)
# #n$yAxis(tickFormat= "#! function() {return d3.format(",.0f") } !#")
# n$xAxis(axisLabel = "Cluster")
# n$params$width = 1200
# n$params$height = 600
#Script for Highcharts
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h$yAxis(title = list(text = "Average ZCTA percentage of population"))
h$xAxis(title = list(text = "Clusters"))
h$xAxis(categories = c("Cluster 1", "Cluster 2", "Cluster 3", "Cluster 4"))
h$params$height = 600
h$params$width = 1200
h
h$publish("Demographic characteristics of clusters", host="gist")
require(slidify)
require(slidifyLibraries)
#author("oct11")
slidify("index.Rmd")
setwd("C:/Users/kylewalker/Dropbox/Health project/Presentation/oct11")
slidify("index.Rmd")
setwd("C:/Users/kylewalker/Dropbox/Health project/Presentation/oct11")
require(slidify)
require(slidifyLibraries)
author("slidifyPres")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
#Script to generate rCharts for October 11 presentation
dir <- "C:/Users/kylewalker/Dropbox/Health project/Data"
setwd(dir)
require(rCharts)
require(plyr)
require(reshape2)
#Chart 1: Bar chart of cluster race & ethnicity
dat <- read.csv("clusters2.csv")
#names(dat)
subvars <- c("cluster", "newpctwhite", "newpctblack", "newpcthisp")
sub <- dat[subvars]
means <- aggregate(sub, by=list(sub$cluster), mean)
means <- rename(means, c("cluster" = "Cluster",
"newpctwhite" = "White",
"newpctblack" = "Black",
"newpcthisp" = "Hispanic"))
means <- means[-1]
meltmeans <- melt(means, id="Cluster")
meltmeans$cl_str <- paste0("Cluster ", as.character(meltmeans$Cluster))
# #Script for NVD3 chart
# n <- nPlot(value~Cluster, group="variable", data=meltmeans, type="multiBarChart")
# #n$chart(color = c("996633", "66ff33", "003399", "cc3300"))
# n$chart(color = c("green", "purple", "orange"))
# n$chart(reduceXTicks= FALSE)
# n$yAxis(axisLabel = "Average percentage in zip code", width = 62)
# #n$yAxis(tickFormat= "#! function() {return d3.format(",.0f") } !#")
# n$xAxis(axisLabel = "Cluster")
# n$params$width = 1200
# n$params$height = 600
#Script for Highcharts
h <- hPlot(x = "cl_str", y = "value", group = "variable", data = meltmeans, type = "column")
h$yAxis(title = list(text = "Average ZCTA percentage of population"))
h$xAxis(title = list(text = "Clusters"))
h$xAxis(categories = c("Cluster 1", "Cluster 2", "Cluster 3", "Cluster 4"))
# h$params$height = 600
# h$params$width = 1200
h
h$publish("Demographic characteristics of clusters", host="gist")
slidify("index.Rmd")
setwd("C:/Users/kylewalker/Dropbox/Health project/Presentation/oct11")
require(slidify)
require(slidifyLibraries)
#author("slidifyPres")
slidify("index.Rmd")
setwd("C:/Users/kylewalker/Dropbox/Health project/Presentation/oct11/slidifyPres")
require(slidify)
require(slidifyLibraries)
#author("slidifyPres")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
require(devtools)
library(devtools)
install_github("slidify")
install_github("slidify", "ramnathv")
install_github("slidifyLibraries", "ramnathv")
slidify("index.Rmd")
setwd("C:/Users/kylewalker/Dropbox/Health project/Presentation/oct11/slidifyPres")
require(slidify)
require(slidifyLibraries)
#author("slidifyPres")
slidify("index.Rmd")
